const CASE_STUDIES = {
  jpratt: {
    title: "Jessie Pratt — Sustainable Design Website",
    subtitle: "Web + Brand · 2025",
    overview:
      "A bilingual website designed for a sustainable residential architectural technologist, focusing on clarity, natural tone, and client conversion.",
    process: [
      "Brand and visual identity alignment",
      "UX structure and wireframing",
      "High-fidelity design in Figma",
      "Front-end build with HTML, CSS, and JavaScript"
    ],
    outcome:
      "Delivered a modern, conversion-focused website that clearly communicates expertise and values.",

    gallery: [
      {
        src: "assets/projects/jpratt/01-home.webp",
        thumb: "assets/projects/jpratt/01-home.webp",
        alt: "Jessie Pratt homepage",
        caption: "Homepage — clear hierarchy and natural tone"
      },
      {
        src: "assets/projects/jpratt/about.webp",
        thumb: "assets/projects/jpratt/about.webp",
        alt: "About section",
        caption: "About — contact info blocks and CTAs"
      },
      {
        src: "assets/projects/jpratt/gallery.webp",
        thumb: "assets/projects/jpratt/gallery.webp",
        alt: "Gallery layout",
        caption: "Gallery — visual layout for clear communication"
      }
    ]
  },

  atelier: {
    title: "Atelier Mélancolie — Online Boutique Concept",
    subtitle: "Web · 2025",
    overview:
      "E-commerce website concept focused on typography, editorial layouts, and a clean product browsing experience.",
    process: [
      "Moodboard + style direction",
      "UI layout system and component planning",
      "Homepage + product section design",
      "Front-end implementation (responsive)"
    ],
    outcome:
      "A strong visual identity translated into a consistent web layout with clear hierarchy and modern interactions.",
    gallery: [
      {
        src: "assets/projects/atelier/pic-2.webp",
        thumb: "assets/projects/atelier/pic-2.webp",
        alt: "Atelier Mélancolie — homepage preview",
        caption: "Homepage — editorial layout + strong typography"
      },
      {
        src: "assets/projects/atelier/pic-1.webp",
        thumb: "assets/projects/atelier/pic-1.webp",
        alt: "Atelier Mélancolie — featured products",
        caption: "Featured products — clean grid and spacing system"
      },
      {
        src: "assets/projects/atelier/pic-4.webp",
        thumb: "assets/projects/atelier/pic-4.webp",
        alt: "Atelier Mélancolie — mobile layout",
        caption: "Mobile — responsive sections and readable type scale"
      },
      {
        src: "assets/projects/atelier/pic-3.webp",
        thumb: "assets/projects/atelier/pic-3.webp",
        alt: "Atelier Mélancolie — mobile layout",
        caption: "Mobile — responsive sections and readable type scale"
      }
    ]
  },
  
  personalBranding: {
    title: "Personal Branding — Motion & Identity",
    subtitle: "Brand + Motion · 2025",
    overview:
      "Personal identity system paired with a motion logo and demo reel to position my work with a clean, confident tone.",
    process: [
      "Logo exploration + typography decisions",
      "Brand system: spacing, tone, and usage rules",
      "Motion tests: timing, easing, transitions",
      "Final animation + reel assembly"
    ],
    outcome:
      "A cohesive personal brand across static and motion formats, designed to feel premium and intentional.",
  

    video: {
      src: "assets/projects/personal-branding/BenoitTourangeau_showreel.mp4",
      poster: "assets/projects/personal-branding/poster.webp",
      caption: "Demo reel — identity translated into motion."
    }
  },
  
  annualReport: {
    title: "Annual Report Design",
    subtitle: "Print · 2024",
    overview:
      "Corporate annual report designed for clarity, consistency, and brand alignment — with clean grids and data-friendly layouts.",
    process: [
      "Grid system + typographic scale",
      "Section templates for repeatable layout",
      "Chart and data styling",
      "Production: prepress checks and export"
    ],
    outcome:
      "A polished, readable report that supports scanning and reinforces brand credibility.",
    gallery: [
      {
        src: "assets/projects/annual-report/mockup1.webp",
        thumb: "assets/projects/annual-report/mockup1.webp",
        alt: "Annual report — cover",
        caption: "Cover — clean corporate tone"
      },
      {
        src: "assets/projects/annual-report/02.webp",
        thumb: "assets/projects/annual-report/02.webp",
        alt: "Annual report — spread",
        caption: "Spread — consistent grid and spacing"
      },
      {
        src: "assets/projects/annual-report/03.webp",
        thumb: "assets/projects/annual-report/03.webp",
        alt: "Annual report — history page",
        caption: "History — background about the company"
      },
      {
        src: "assets/projects/annual-report/04.webp",
        thumb: "assets/projects/annual-report/04.webp",
        alt: "Annual report — illustration",
        caption: "Illustration — custom imagery that aligns with branding"
      },
      {
        src: "assets/projects/annual-report/05.webp",
        thumb: "assets/projects/annual-report/05.webp",
        alt: "Annual report — data page",
        caption: "Data — readable hierarchy and alignment"
      }
    ]
  },
  
  archMag: {
    title: "Architecture Magazine",
    subtitle: "Print · 2024",
    overview:
      "Multi-page editorial magazine exploring modern architecture through layout systems, visual pacing, and typographic discipline.",
    process: [
      "Art direction and editorial pacing plan",
      "Grid system + type rules",
      "Spread design: rhythm, contrast, and whitespace",
      "Final assembly and print-ready export"
    ],
    outcome:
      "A cohesive magazine layout system that feels modern, structured, and visually calm.",
    gallery: [
      {
        src: "assets/projects/architecture-mag/01.webp",
        thumb: "assets/projects/architecture-mag/01.webp",
        alt: "Architecture magazine — Mockup",
        caption: "Mockup — bold type and clean structure"
      },
      {
        src: "assets/projects/architecture-mag/02.webp",
        thumb: "assets/projects/architecture-mag/02.webp",
        alt: "Architecture magazine — spread",
        caption: "Spread — grid system + visual pacing"
      },
      {
        src: "assets/projects/architecture-mag/03.webp",
        thumb: "assets/projects/architecture-mag/03.webp",
        alt: "Architecture magazine — detail page",
        caption: "Details — typography-led hierarchy"
      },
      {
        src: "assets/projects/architecture-mag/04.webp",
        thumb: "assets/projects/architecture-mag/04.webp",
        alt: "Architecture magazine — imagery",
        caption: "Imagery — full page"
      },
      {
        src: "assets/projects/architecture-mag/05.webp",
        thumb: "assets/projects/architecture-mag/05.webp",
        alt: "Architecture magazine — back cover",
        caption: "Back cover — ad placement"
      }
    ]
  },
  
  proteiballs: {
    title: "ProteiBalls — Brand & Packaging",
    subtitle: "Brand + Print · 2024",
    overview:
      "Brand identity and packaging system for a nutrition product focused on bold shelf presence and a clear product story.",
    process: [
      "Brand direction: tone, audience, positioning",
      "Logo and visual system development",
      "Packaging layout + hierarchy for quick scanning",
      "Mockups and print-ready exports"
    ],
    outcome:
      "A cohesive packaging system that feels energetic, legible, and consistent across variants.",
    gallery: [
      {
        src: "assets/projects/proteiballs/mockup.webp",
        thumb: "assets/projects/proteiballs/mockup.webp",
        alt: "ProteiBalls — logo and identity",
        caption: "Identity — logo + core brand elements"
      },
      {
        src: "assets/projects/proteiballs/02.webp",
        thumb: "assets/projects/proteiballs/02.webp",
        alt: "ProteiBalls — packaging front",
        caption: "Packaging — strong hierarchy and shelf presence"
      },
      {
        src: "assets/projects/proteiballs/03.webp",
        thumb: "assets/projects/proteiballs/03.webp",
        alt: "ProteiBalls — mockups",
        caption: "Mockups — consistency across applications"
      },
      {
        src: "assets/projects/proteiballs/04.webp",
        thumb: "assets/projects/proteiballs/04.webp",
        alt: "ProteiBalls — mockups",
        caption: "Mockups — consistency across applications"
      }
    ]
  }
  
};

  

(() => {
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));
  

    const year = $("#year");
    if (year) year.textContent = new Date().getFullYear();

    const header = document.querySelector("[data-elevate]");
    const onScroll = () => header?.classList.toggle("is-elevated", window.scrollY > 6);
    window.addEventListener("scroll", onScroll, { passive: true });
    onScroll();
  

    const toggle = $(".nav__toggle");
    const menu = $("#navMenu");
    if (toggle && menu) {
      const close = () => {
        menu.classList.remove("is-open");
        toggle.setAttribute("aria-expanded", "false");
      };
  
      toggle.addEventListener("click", () => {
        const isOpen = menu.classList.toggle("is-open");
        toggle.setAttribute("aria-expanded", String(isOpen));
      });
  
      $$(".nav__link", menu).forEach(a => a.addEventListener("click", close));
  
      document.addEventListener("click", (e) => {
        if (!menu.classList.contains("is-open")) return;
        if (menu.contains(e.target) || toggle.contains(e.target)) return;
        close();
      });
  
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") close();
      });
    }
  

    const chips = $$(".chip");
    const cards = $$(".workCard");
    const setActive = (btn) => {
      chips.forEach(c => c.classList.remove("is-active"));
      btn.classList.add("is-active");
    };
    const applyFilter = (filter) => {
      cards.forEach(card => {
        const tags = (card.dataset.tags || "").split(" ");
        const show = filter === "all" || tags.includes(filter);
        card.style.display = show ? "" : "none";
      });
    };
    chips.forEach(chip => {
      chip.addEventListener("click", () => {
        const filter = chip.dataset.filter || "all";
        setActive(chip);
        applyFilter(filter);
      });
    });
  

    const revealEls = $$("[data-reveal]");
    const io = new IntersectionObserver(
      (entries) => {
        entries.forEach((entry) => {
          if (!entry.isIntersecting) return;
          entry.target.classList.add("is-revealed");
          io.unobserve(entry.target);
        });
      },
      { threshold: 0.12 }
    );
    revealEls.forEach(el => io.observe(el));
  

    const copyBtn = document.querySelector("[data-copy]");
    if (copyBtn) {
      copyBtn.addEventListener("click", async () => {
        const text = copyBtn.getAttribute("data-copy") || "";
        try {
          await navigator.clipboard.writeText(text);
          const old = copyBtn.textContent;
          copyBtn.textContent = "Copied!";
          setTimeout(() => (copyBtn.textContent = old), 900);
        } catch {
          alert("Copy failed. Please copy manually: " + text);
        }
      });
    }
  

    const topBtn = document.querySelector("[data-top]");
    topBtn?.addEventListener("click", () => window.scrollTo({ top: 0, behavior: "smooth" }));
  

    const videos = Array.from(document.querySelectorAll(".workCard__thumb video"));
    if (videos.length) {
      const vio = new IntersectionObserver((entries) => {
        entries.forEach(({ target, isIntersecting }) => {
          if (!(target instanceof HTMLVideoElement)) return;
          if (isIntersecting) target.play().catch(() => {});
          else target.pause();
        });
      }, { threshold: 0.25 });
  
      videos.forEach(v => vio.observe(v));
    }
  })();
  
  const modal = document.getElementById("caseModal");

let activeKey = null;
let activeIndex = 0;

function openCaseStudy(key) {
  const data = CASE_STUDIES[key];
  if (!data) return;

  activeKey = key;
  activeIndex = 0;

  modal.querySelector(".caseModal__title").textContent = data.title || "";
  modal.querySelector(".caseModal__subtitle").textContent = data.subtitle || "";
  modal.querySelector(".caseModal__overview").textContent = data.overview || "";
  modal.querySelector(".caseModal__outcome").textContent = data.outcome || "";

  const processList = modal.querySelector(".caseModal__process");
  processList.innerHTML = "";
  (data.process || []).forEach(step => {
    const li = document.createElement("li");
    li.textContent = step;
    processList.appendChild(li);
  });

  renderMedia(data);
  modal.classList.add("is-open");
  modal.setAttribute("aria-hidden", "false");
  document.body.style.overflow = "hidden";


  modal.querySelector(".caseModal__close")?.focus();
}

function closeModal() {
  modal.classList.remove("is-open");
  modal.setAttribute("aria-hidden", "true");
  document.body.style.overflow = "";
  activeKey = null;
  const v = modal.querySelector(".caseVideo__player");
  if (v) v.pause();
}

function renderGallery(gallery) {
  const img = modal.querySelector(".caseGallery__img");
  const cap = modal.querySelector(".caseGallery__caption");
  const thumbsWrap = modal.querySelector(".caseGallery__thumbs");
  const prevBtn = modal.querySelector(".caseGallery__prev");
  const nextBtn = modal.querySelector(".caseGallery__next");


  const galleryRoot = modal.querySelector(".caseGallery");
  if (!gallery.length) {
    galleryRoot.style.display = "none";
    return;
  }
  galleryRoot.style.display = "";


  thumbsWrap.innerHTML = "";
  gallery.forEach((item, i) => {
    const b = document.createElement("button");
    b.type = "button";
    b.className = "caseGallery__thumb";
    b.setAttribute("role", "listitem");
    b.addEventListener("click", () => {
      activeIndex = i;
      updateStage(gallery);
    });

    const t = document.createElement("img");
    t.src = item.thumb || item.src;
    t.alt = item.alt || "";
    t.loading = "lazy";
    b.appendChild(t);

    thumbsWrap.appendChild(b);
  });

  prevBtn.onclick = () => {
    activeIndex = (activeIndex - 1 + gallery.length) % gallery.length;
    updateStage(gallery);
  };
  nextBtn.onclick = () => {
    activeIndex = (activeIndex + 1) % gallery.length;
    updateStage(gallery);
  };


  updateStage(gallery);

  function updateStage(gal) {
    const item = gal[activeIndex];
    img.src = item.src;
    img.alt = item.alt || "";
    cap.textContent = item.caption || "";


    const thumbBtns = Array.from(thumbsWrap.children);
    thumbBtns.forEach((el, idx) => el.classList.toggle("is-active", idx === activeIndex));


    const disableNav = gal.length <= 1;
    prevBtn.disabled = disableNav;
    nextBtn.disabled = disableNav;


    const activeThumb = thumbBtns[activeIndex];
    if (activeThumb) activeThumb.scrollIntoView({ behavior: "smooth", inline: "center", block: "nearest" });
  }
}


document.querySelectorAll("[data-case]").forEach(btn => {
  btn.addEventListener("click", () => openCaseStudy(btn.dataset.case));
});


modal.querySelectorAll("[data-close]").forEach(el => el.addEventListener("click", closeModal));
document.addEventListener("keydown", (e) => {
  if (!modal.classList.contains("is-open")) return;
  if (e.key === "Escape") closeModal();


  const data = activeKey ? CASE_STUDIES[activeKey] : null;
  const gallery = data?.gallery || [];
  if (!gallery.length) return;

  if (e.key === "ArrowLeft") {
    activeIndex = (activeIndex - 1 + gallery.length) % gallery.length;

    const nextBtn = modal.querySelector(".caseGallery__next");
    nextBtn?.dispatchEvent(new Event("noop"));

    renderGallery(gallery);
  }
  if (e.key === "ArrowRight") {
    activeIndex = (activeIndex + 1) % gallery.length;
    renderGallery(gallery);
  }
});

function renderMedia(data) {
  const galleryRoot = modal.querySelector(".caseGallery");
  const videoWrap = modal.querySelector(".caseVideo");
  const videoEl = modal.querySelector(".caseVideo__player");
  const sourceEl = videoEl?.querySelector("source");
  const captionEl = modal.querySelector(".caseVideo__caption");


  if (data.video?.src) {
    if (galleryRoot) galleryRoot.style.display = "none";
    if (videoWrap) videoWrap.hidden = false;


    if (sourceEl) sourceEl.src = data.video.src;
    if (data.video.poster) videoEl.poster = data.video.poster;
    if (captionEl) captionEl.textContent = data.video.caption || "";


    videoEl.load();
    return;
  }


  if (videoWrap) {
    videoWrap.hidden = true;
    if (videoEl) {
      videoEl.pause();
      if (sourceEl) sourceEl.src = "";
      videoEl.removeAttribute("poster");
      videoEl.load();
    }
  }

  if (galleryRoot) galleryRoot.style.display = "";
  renderGallery(data.gallery || []);
}

